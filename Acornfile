containers: {
    website: {
        image: "gamelaster/opensupports:latest"
        ports: publish: [
            "80/http"
        ]
        env: {
            TIMEZONE: "secret://env/timezone"
        }
        dirs: {
            "/config": "volume://config"
        }
        dependsOn: ["mariadb"]
        consumes: ["mariadb"]
    }
}

services: mariadb: {
    image: "ghcr.io/acorn-io/mariadb:v10.#.#-#" // pulls the latest 10.x version
    environment: {
        MYSQL_USER: "opensupports"
        MYSQL_DATABASE: "opensupports"
        MYSQL_RANDOM_ROOT_PASSWORD: "true"
        MYSQL_PASSWORD: "secret://env/mysql_password"
    }
}

secrets: env: {
    external: "opensupports"
}

volumes: config: {
    size: "1G"
    accessModes: "readWriteOnce"
}